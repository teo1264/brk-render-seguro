# ğŸš€ BRK Monitor - ConfiguraÃ§Ã£o Render Deploy
# 
# Este arquivo configura deploy automÃ¡tico no Render.com
# Funcionalidades: Build, Environment, Persistent Disk

services:
  - type: web
    name: brk-monitor
    env: python
    plan: free
    
    # ğŸ“¦ Build Configuration
    buildCommand: pip install -r requirements.txt
    startCommand: python app.py
    
    # ğŸŒ Network Configuration  
    healthCheckPath: /health
    
    # ğŸ“ Persistent Storage (CRÃTICO para SQLite)
    disk:
      name: brk-storage
      mountPath: /opt/render/project/storage
      sizeGB: 1
    
    # ğŸ”’ Environment Variables (Configure no Dashboard)
    envVars:
      - key: MICROSOFT_CLIENT_ID
        sync: false  # Configurar manualmente no Dashboard
      
      - key: PASTA_BRK_ID  
        sync: false  # Configurar manualmente no Dashboard
        
      - key: MICROSOFT_TENANT_ID
        value: consumers  # Valor padrÃ£o
        
      - key: PORT
        value: 8080  # Render define automaticamente
        
    # ğŸ”„ Auto Deploy
    autoDeploy: true
    
    # ğŸ“‹ ConfiguraÃ§Ãµes Adicionais
    region: oregon  # RegiÃ£o padrÃ£o (pode alterar)
    
    # ğŸ›¡ï¸ Health Check
    healthCheckPath: /health
    healthCheckGracePeriod: 30s

# ğŸ“ InstruÃ§Ãµes de Uso:
#
# 1. CONECTAR REPOSITÃ“RIO:
#    - Render.com â†’ New Web Service  
#    - Connect GitHub â†’ brk-monitor-seguro
#    - Render detectarÃ¡ este arquivo automaticamente
#
# 2. CONFIGURAR VARIÃVEIS OBRIGATÃ“RIAS:
#    - Dashboard â†’ Environment â†’ Add Variable:
#      â€¢ MICROSOFT_CLIENT_ID = seu_client_id
#      â€¢ PASTA_BRK_ID = seu_pasta_id  
#
# 3. DEPLOY AUTOMÃTICO:
#    - Render usarÃ¡ as configuraÃ§Ãµes deste arquivo
#    - Build: pip install -r requirements.txt
#    - Start: python app.py
#    - Storage: 1GB persistent disk em /opt/render/project/storage
#
# 4. VERIFICAR FUNCIONAMENTO:
#    - Health check: https://seu-app.onrender.com/health
#    - Status: https://seu-app.onrender.com/
#    - Upload token: https://seu-app.onrender.com/upload-token

# âš ï¸ IMPORTANTE:
# - MICROSOFT_CLIENT_ID e PASTA_BRK_ID devem ser configurados manualmente
# - Persistent disk Ã© ESSENCIAL para SQLite funcionar
# - Health check monitora se aplicaÃ§Ã£o estÃ¡ funcionando
