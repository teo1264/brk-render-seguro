# ğŸš€ BRK Monitor - ConfiguraÃ§Ã£o Render Deploy (MODULAR)
# 
# ConfiguraÃ§Ã£o atualizada para estrutura modular:
# auth/ + processor/ + admin/ + app.py

services:
  - type: web
    name: brk-monitor
    env: python
    plan: free
    
    # ğŸ“¦ Build Configuration
    buildCommand: pip install -r requirements.txt
    startCommand: python app.py
    
    # ğŸŒ Network Configuration  
    healthCheckPath: /health
    
    # ğŸ“ Persistent Storage (CRÃTICO para SQLite + tokens)
    disk:
      name: brk-storage
      mountPath: /opt/render/project/storage
      sizeGB: 1
    
    # ğŸ”’ Environment Variables (Configure no Dashboard)
    envVars:
      - key: MICROSOFT_CLIENT_ID
        sync: false  # Configurar manualmente no Dashboard
      
      - key: PASTA_BRK_ID  
        sync: false  # Configurar manualmente no Dashboard
        
      - key: MICROSOFT_TENANT_ID
        value: consumers  # Valor padrÃ£o
        
      - key: PORT
        value: 8080  # Render define automaticamente
        
      - key: EXECUTAR_ADMIN_SERVER
        value: true  # ğŸ†• Servidor admin habilitado por padrÃ£o
        
    # ğŸ”„ Auto Deploy
    autoDeploy: true
    
    # ğŸ“‹ ConfiguraÃ§Ãµes Adicionais
    region: oregon  # RegiÃ£o padrÃ£o (pode alterar)
    
    # ğŸ›¡ï¸ Health Check
    healthCheckPath: /health
    healthCheckGracePeriod: 30s

# ğŸ“ InstruÃ§Ãµes Atualizadas:
#
# 1. ESTRUTURA MODULAR SUPORTADA:
#    - auth/microsoft_auth.py â†’ AutenticaÃ§Ã£o Microsoft
#    - processor/email_processor.py â†’ Processamento emails
#    - admin/admin_server.py â†’ Interface administrativa
#    - app.py â†’ OrquestraÃ§Ã£o principal
#
# 2. VARIÃVEIS OBRIGATÃ“RIAS:
#    - MICROSOFT_CLIENT_ID = seu_client_id
#    - PASTA_BRK_ID = seu_pasta_id
#    - EXECUTAR_ADMIN_SERVER = true (servidor web incluÃ­do)
#
# 3. ENDPOINTS DISPONÃVEIS:
#    - / â†’ Interface administrativa
#    - /upload-token â†’ Upload seguro de token
#    - /health â†’ Health check JSON
#    - /status â†’ Status detalhado sistema
#    - /test-onedrive â†’ Teste conectividade OneDrive
#    - /create-brk-folder â†’ Criar pasta /BRK
#
# 4. FUNCIONAMENTO:
#    - app.py â†’ Processamento automÃ¡tico (10min) + Servidor admin
#    - Persistent disk â†’ tokens + SQLite + PDFs simulados
#    - Logs â†’ Estrutura modular visÃ­vel
#
# 5. DEPLOY PROCESS:
#    - GitHub push â†’ Auto deploy
#    - Build â†’ pip install requirements.txt
#    - Start â†’ python app.py (hÃ­brido: processamento + web)
#    - Health â†’ /health endpoint ativo

# âš¡ PERFORMANCE OTIMIZADA:
# - MÃ³dulos separados = imports mais rÃ¡pidos
# - Classes especializadas = menos overhead
# - Processamento isolado = melhor debugging
# - Interface separada = manutenÃ§Ã£o simplificada

# ğŸ”® PREPARADO PARA CRESCIMENTO:
# - admin/ pronto para dashboard avanÃ§ado
# - processor/ pronto para OCR real
# - auth/ pronto para OneDrive real
# - app.py mantÃ©m coordenaÃ§Ã£o simples
